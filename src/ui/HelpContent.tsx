import { useState } from 'react';
import { RadioGroup } from './Miui';
import AnimatedContent from './AnimatedContent';
import Spacer from './Spacer';
import IconBtn from './IconBtn';
import ShuqianItem from './ShuqianItem';

function HelpContent() {
    type GetMethod = '浏览器工具' | '手机获取' | '电脑获取';
    const [getMethod, setGetMethod] = useState<GetMethod>('浏览器工具');

    return (
        <div style={{
            width: 'calc(100 % - 56px)',
            margin: '16px',
            padding: '12px',
            borderRadius: '16px',
            border: '2px solid #ddd',
            backgroundColor: '#f0f0f0',
            display: 'flex',
            justifyContent: 'center',
            alignItems: 'center',
            flexDirection: 'column'
        }}>
            <div style={{
                lineHeight: '20px',
                fontWeight: '500'
            }}>ccmz获取方式</div>
            <RadioGroup
                options={['浏览器工具', '手机获取', '电脑获取']}
                value={getMethod}
                onChange={(val) => setGetMethod(val as GetMethod)}
            />
            <Spacer height='4px' />
            <div style={{
                backgroundColor: '#fff',
                width: '100%',
                borderRadius: '12px',
            }}><div style={{ padding: '12px' }}>
                    <AnimatedContent targetState={getMethod}>
                        {(type) => (
                            <div>
                                {type === '浏览器工具' && (
                                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                                        <div style={{ padding: '4px 4px 0', fontSize: '14px', color: '#444' }}>
                                            对于电脑用户，可以将此书签直接拖动到书签栏：
                                        </div>
                                        <ShuqianItem
                                            link={`javascript:(async()=>{const e="${location.href}";try{const t=document.querySelector("iframe");if(!t)throw 1;const n=new URL(t.src).searchParams.get("url");if(!n)throw 1;const o=await fetch(n);let a="";const s=o.headers.get("content-disposition");if(s){const e=s.match(/filename\*=UTF-8''([^;]+)/i)||s.match(/filename="?([^";]+)"?/i);e&&(a=decodeURIComponent(e[1]))}if(!a){const e=new URL(n).pathname.split("/").pop();e&&(a=decodeURIComponent(e))}a||(a="download.bin");const c=parseInt(o.headers.get("content-length"),10)||0,i=o.body.getReader(),d=window.open(e);window.addEventListener("message",async e=>{if("READY"===e.data)for(;;){const{done:e,value:t}=await i.read();if(e){d.postMessage({action:"DONE",filename:a},"*");break}d.postMessage({action:"CHUNK",chunk:t,total:c},"*",[t.buffer])}})}catch(t){window.open(e)}})();`}
                                            text="ccmz解析工具" />
                                        <div style={{ padding: '4px 4px 0', fontSize: '14px', color: '#444' }}>
                                            在官网打开曲谱详情页后点击可直接下载
                                        </div>

                                        <div style={{ padding: '4px 4px 0', fontSize: '14px', color: '#444', marginTop: '8px' }}>
                                            另外，你可以通过安装Tampermonkey脚本来实现：
                                        </div>
                                        <IconBtn onClick={() => {
                                            open('https://update.greasyfork.org/scripts/457019/虫虫钢琴铺面查看脚本.user.js');
                                        }}>
                                            <svg viewBox="0 0 250.67 250.67" xmlns="http://www.w3.org/2000/svg" width="14px" height="14px"><path d="m62.115 0c-34.412 0-62.115 27.703-62.115 62.115v126.44c0 34.412 27.703 62.115 62.115 62.115h126.44c34.412 0 62.115-27.703 62.115-62.115v-126.44c0-34.412-27.703-62.115-62.115-62.115zm4.6758 132.58a51.124 51.124 0 0 1 5.1035 0.25586 51.124 51.124 0 0 1 5.0527 0.76367 51.124 51.124 0 0 1 4.9512 1.2637 51.124 51.124 0 0 1 4.8008 1.7539 51.124 51.124 0 0 1 4.6016 2.2226 51.124 51.124 0 0 1 4.3574 2.6699 51.124 51.124 0 0 1 4.0684 3.0938 51.124 51.124 0 0 1 3.7383 3.4824 51.124 51.124 0 0 1 3.373 3.8398 51.124 51.124 0 0 1 2.9727 4.1562 51.124 51.124 0 0 1 2.543 4.4336 51.124 51.124 0 0 1 2.0879 4.6641 51.124 51.124 0 0 1 1.6113 4.8496 51.124 51.124 0 0 1 1.1192 4.9863 51.124 51.124 0 0 1 0.61523 5.0723 51.124 51.124 0 0 1 0.12891 3.6172 51.124 51.124 0 0 1-0.25586 5.1035 51.124 51.124 0 0 1-0.76368 5.0527 51.124 51.124 0 0 1-1.2656 4.9512 51.124 51.124 0 0 1-1.752 4.8008 51.124 51.124 0 0 1-2.2227 4.6016 51.124 51.124 0 0 1-2.6699 4.3574 51.124 51.124 0 0 1-3.0938 4.0684 51.124 51.124 0 0 1-3.4824 3.7383 51.124 51.124 0 0 1-3.8398 3.373 51.124 51.124 0 0 1-4.1562 2.9727 51.124 51.124 0 0 1-4.4336 2.543 51.124 51.124 0 0 1-4.6641 2.0879 51.124 51.124 0 0 1-4.8496 1.6113 51.124 51.124 0 0 1-4.9863 1.1191 51.124 51.124 0 0 1-5.0723 0.61523 51.124 51.124 0 0 1-3.6172 0.12695 51.124 51.124 0 0 1-5.1035-0.2539 51.124 51.124 0 0 1-5.0527-0.76367 51.124 51.124 0 0 1-4.9512-1.2656 51.124 51.124 0 0 1-4.8008-1.752 51.124 51.124 0 0 1-4.6016-2.2227 51.124 51.124 0 0 1-4.3574-2.6719 51.124 51.124 0 0 1-4.0684-3.0918 51.124 51.124 0 0 1-3.7383-3.4824 51.124 51.124 0 0 1-3.373-3.8398 51.124 51.124 0 0 1-2.9727-4.1563 51.124 51.124 0 0 1-2.543-4.4336 51.124 51.124 0 0 1-2.0879-4.6641 51.124 51.124 0 0 1-1.6113-4.8496 51.124 51.124 0 0 1-1.1191-4.9863 51.124 51.124 0 0 1-0.61523-5.0742 51.124 51.124 0 0 1-0.12891-3.6152 51.124 51.124 0 0 1 0.25586-5.1035 51.124 51.124 0 0 1 0.76367-5.0527 51.124 51.124 0 0 1 1.2637-4.9531 51.124 51.124 0 0 1 1.7539-4.7988 51.124 51.124 0 0 1 2.2227-4.6016 51.124 51.124 0 0 1 2.6699-4.3574 51.124 51.124 0 0 1 3.0938-4.0684 51.124 51.124 0 0 1 3.4824-3.7383 51.124 51.124 0 0 1 3.8398-3.373 51.124 51.124 0 0 1 4.1562-2.9726 51.124 51.124 0 0 1 4.4336-2.543 51.124 51.124 0 0 1 4.6641-2.0879 51.124 51.124 0 0 1 4.8496-1.6113 51.124 51.124 0 0 1 4.9863-1.1191 51.124 51.124 0 0 1 5.0723-0.61524 51.124 51.124 0 0 1 3.6172-0.1289zm117.54 0a51.124 51.124 0 0 1 5.1035 0.25586 51.124 51.124 0 0 1 5.0527 0.76367 51.124 51.124 0 0 1 4.9531 1.2637 51.124 51.124 0 0 1 4.7988 1.7539 51.124 51.124 0 0 1 4.6016 2.2226 51.124 51.124 0 0 1 4.3574 2.6699 51.124 51.124 0 0 1 4.0684 3.0938 51.124 51.124 0 0 1 3.7383 3.4824 51.124 51.124 0 0 1 3.373 3.8398 51.124 51.124 0 0 1 2.9727 4.1562 51.124 51.124 0 0 1 2.543 4.4336 51.124 51.124 0 0 1 2.0879 4.6641 51.124 51.124 0 0 1 1.6113 4.8496 51.124 51.124 0 0 1 1.1191 4.9863 51.124 51.124 0 0 1 0.61523 5.0723 51.124 51.124 0 0 1 0.12891 3.6172 51.124 51.124 0 0 1-0.25586 5.1035 51.124 51.124 0 0 1-0.76367 5.0527 51.124 51.124 0 0 1-1.2637 4.9512 51.124 51.124 0 0 1-1.7539 4.8008 51.124 51.124 0 0 1-2.2227 4.6016 51.124 51.124 0 0 1-2.6699 4.3574 51.124 51.124 0 0 1-3.0938 4.0684 51.124 51.124 0 0 1-3.4824 3.7383 51.124 51.124 0 0 1-3.8398 3.373 51.124 51.124 0 0 1-4.1563 2.9727 51.124 51.124 0 0 1-4.4336 2.543 51.124 51.124 0 0 1-4.6641 2.0879 51.124 51.124 0 0 1-4.8496 1.6113 51.124 51.124 0 0 1-4.9863 1.1191 51.124 51.124 0 0 1-5.0723 0.61523 51.124 51.124 0 0 1-3.6172 0.12695 51.124 51.124 0 0 1-5.1035-0.2539 51.124 51.124 0 0 1-5.0527-0.76367 51.124 51.124 0 0 1-4.9512-1.2656 51.124 51.124 0 0 1-4.8008-1.752 51.124 51.124 0 0 1-4.6016-2.2227 51.124 51.124 0 0 1-4.3574-2.6719 51.124 51.124 0 0 1-4.0684-3.0918 51.124 51.124 0 0 1-3.7383-3.4824 51.124 51.124 0 0 1-3.373-3.8398 51.124 51.124 0 0 1-2.9726-4.1563 51.124 51.124 0 0 1-2.543-4.4336 51.124 51.124 0 0 1-2.0879-4.6641 51.124 51.124 0 0 1-1.6113-4.8496 51.124 51.124 0 0 1-1.1191-4.9863 51.124 51.124 0 0 1-0.61524-5.0742 51.124 51.124 0 0 1-0.12695-3.6152 51.124 51.124 0 0 1 0.25391-5.1035 51.124 51.124 0 0 1 0.76367-5.0527 51.124 51.124 0 0 1 1.2656-4.9531 51.124 51.124 0 0 1 1.752-4.7988 51.124 51.124 0 0 1 2.2226-4.6016 51.124 51.124 0 0 1 2.6719-4.3574 51.124 51.124 0 0 1 3.0918-4.0684 51.124 51.124 0 0 1 3.4824-3.7383 51.124 51.124 0 0 1 3.8398-3.373 51.124 51.124 0 0 1 4.1562-2.9726 51.124 51.124 0 0 1 4.4336-2.543 51.124 51.124 0 0 1 4.6641-2.0879 51.124 51.124 0 0 1 4.8496-1.6113 51.124 51.124 0 0 1 4.9863-1.1191 51.124 51.124 0 0 1 5.0742-0.61524 51.124 51.124 0 0 1 3.6152-0.1289z" fill="#b70000" /></svg>
                                            安装Tampermonkey脚本
                                        </IconBtn>
                                    </div>
                                )}
                                {type === '手机获取' && (
                                    <div style={{ padding: '4px 4px 0', fontSize: '14px', color: '#666' }}>
                                        扫码或通过移动端 App 访问，随时随地查看和同步信息。
                                    </div>
                                )}
                                {type === '电脑获取' && (
                                    <div style={{ padding: '4px 4px 0', fontSize: '14px', color: '#666' }}>
                                        下载桌面客户端，支持更强大的本地处理能力和离线模式。
                                    </div>
                                )}
                            </div>
                        )}
                    </AnimatedContent>
                </div>
            </div>
        </div>
    )
}

export default HelpContent;